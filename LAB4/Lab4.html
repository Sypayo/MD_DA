<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1251"><meta name="viewport" content="width=device-width"><title>file:///C:/Users/%D0%9C%D0%B0%D0%BA%D1%81%D0%B8%D0%BC/Desktop/MD_DA-master/Lab%204/Lab4.html</title><link rel="stylesheet" type="text/css" href="resource://content-accessible/viewsource.css"></head><body id="viewsource" class="highlight" style="-moz-tab-size: 4" contextmenu="actions"><pre id="line1"><span># Козарев М.Ю. РИ-450005
<span id="line2"></span>
<span id="line3"></span>#Пользуясь примером из лекции файл (5.0.R) проанализируйте данные
<span id="line4"></span>#о возрасте и физ. характеристиках молюсков
<span id="line5"></span>#https://archive.ics.uci.edu/ml/datasets/abalone
<span id="line6"></span>
<span id="line7"></span>```
<span id="line8"></span>data </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data", header=TRUE, sep=",")
<span id="line9"></span>&gt; summary(data)
<span id="line10"></span> M            X0.455          X0.365      
<span id="line11"></span> F:1307   Min.   :0.075   Min.   :0.0550  
<span id="line12"></span> I:1342   1st Qu.:0.450   1st Qu.:0.3500  
<span id="line13"></span> M:1527   Median :0.545   Median :0.4250  
<span id="line14"></span>          Mean   :0.524   Mean   :0.4079  
<span id="line15"></span>          3rd Qu.:0.615   3rd Qu.:0.4800  
<span id="line16"></span>          Max.   :0.815   Max.   :0.6500  
<span id="line17"></span>     X0.095           X0.514          X0.2245      
<span id="line18"></span> Min.   :0.0000   Min.   :0.0020   Min.   :0.0010  
<span id="line19"></span> 1st Qu.:0.1150   1st Qu.:0.4415   1st Qu.:0.1860  
<span id="line20"></span> Median :0.1400   Median :0.7997   Median :0.3360  
<span id="line21"></span> Mean   :0.1395   Mean   :0.8288   Mean   :0.3594  
<span id="line22"></span> 3rd Qu.:0.1650   3rd Qu.:1.1533   3rd Qu.:0.5020  
<span id="line23"></span> Max.   :1.1300   Max.   :2.8255   Max.   :1.4880  
<span id="line24"></span>     X0.101            X0.15             X15        
<span id="line25"></span> Min.   :0.00050   Min.   :0.0015   Min.   : 1.000  
<span id="line26"></span> 1st Qu.:0.09337   1st Qu.:0.1300   1st Qu.: 8.000  
<span id="line27"></span> Median :0.17100   Median :0.2340   Median : 9.000  
<span id="line28"></span> Mean   :0.18061   Mean   :0.2389   Mean   : 9.932  
<span id="line29"></span> 3rd Qu.:0.25300   3rd Qu.:0.3290   3rd Qu.:11.000  
<span id="line30"></span> Max.   :0.76000   Max.   :1.0050   Max.   :29.000  
<span id="line31"></span> &gt; colnames(data)
<span id="line32"></span>[1] "M"       "X0.455"  "X0.365"  "X0.095"  "X0.514" 
<span id="line33"></span>[6] "X0.2245" "X0.101"  "X0.15"   "X15" 
<span id="line34"></span>&gt; colnames(data) </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> c("sex", "length", "diameter", "height", 
<span id="line35"></span>+                     "whole_weight", "shucked_weight",
<span id="line36"></span>+                     "viscera_weight", "shell_weight", "rings")
<span id="line37"></span>&gt; colnames(data)
<span id="line38"></span>[1] "sex"            "length"         "diameter"      
<span id="line39"></span>[4] "height"         "whole_weight"   "shucked_weight"
<span id="line40"></span>[7] "viscera_weight" "shell_weight"   "rings" 
<span id="line41"></span>&gt; data$sex </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> factor(c("Female", "Infant", "Male")[data$sex])
<span id="line42"></span>&gt; 
<span id="line43"></span>&gt; par(mfrow=c(1,3)) 
<span id="line44"></span>&gt; 
<span id="line45"></span>&gt; hist(data$diameter, main = "Диаметр, мм")
<span id="line46"></span>Error in plot.new() : figure margins too large
<span id="line47"></span>&gt; 
<span id="line48"></span>&gt; hist(data$diameter, main = "Диаметр, мм")
<span id="line49"></span>&gt; 
<span id="line50"></span>&gt; hist(data$height, main = "Высота, мм")
<span id="line51"></span>&gt; 
<span id="line52"></span>&gt; hist(data$whole_weight, main = "Полный вес, гр")
<span id="line53"></span>```
<span id="line54"></span>
<span id="line55"></span>#Видим ассиметрию https://en.wikipedia.org/wiki/Skewness
<span id="line56"></span>#и выбросы (от них нужно избавиться)
<span id="line57"></span>
<span id="line58"></span>#Визулизируем возможные зависимости
<span id="line59"></span>
<span id="line60"></span>```
<span id="line61"></span>&gt; par(mfrow=c(1,2)) 
<span id="line62"></span>&gt; 
<span id="line63"></span>&gt; plot(data$diameter, data$whole_weight,'p',main = "Зависимость веса от диаметра")
<span id="line64"></span>&gt; 
<span id="line65"></span>&gt; plot(data$height, data$whole_weight,'p',main = "Зависимость веса от высоты")
<span id="line66"></span>```
<span id="line67"></span>
<span id="line68"></span>#Хорошо видна зависимость, нужно её исследовать
<span id="line69"></span>#построить линейные модели при помощи функции lm, посмотреть их характеристики
<span id="line70"></span>
<span id="line71"></span>```
<span id="line72"></span>&gt; lin_model1 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(data$diameter ~ data$whole_weight)
<span id="line73"></span>&gt; summary(lin_model1)
<span id="line74"></span>Call:
<span id="line75"></span>lm(formula = data$diameter ~ data$whole_weight)
<span id="line76"></span>Residuals:
<span id="line77"></span>      Min        1Q    Median        3Q       Max 
<span id="line78"></span>-0.198038 -0.015281  0.008041  0.024858  0.114478 
<span id="line79"></span>Coefficients:
<span id="line80"></span>                  Estimate Std. Error t value Pr(&gt;|t|)
<span id="line81"></span>(Intercept)       0.252664   0.001143   221.1   </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16
<span id="line82"></span>data$whole_weight 0.187288   0.001187   157.8   </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16
<span id="line83"></span>                     
<span id="line84"></span>(Intercept)       ***
<span id="line85"></span>data$whole_weight ***
<span id="line86"></span>---
<span id="line87"></span>Signif. codes:  
<span id="line88"></span>0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
<span id="line89"></span>Residual standard error: 0.03761 on 4174 degrees of freedom
<span id="line90"></span>Multiple R-squared:  0.8565,	Adjusted R-squared:  0.8564 
<span id="line91"></span>F-statistic: 2.491e+04 on 1 and 4174 DF,  p-value: </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2.2e-16
<span id="line92"></span>&gt; plot(lin.Model1)
<span id="line93"></span>&gt; lin.Model2 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(data$height ~ data$whole_weight)
<span id="line94"></span>&gt; summary(lin.Model2)
<span id="line95"></span>Call:
<span id="line96"></span>lm(formula = data$height ~ data$whole_weight)
<span id="line97"></span>Residuals:
<span id="line98"></span>     Min       1Q   Median       3Q      Max 
<span id="line99"></span>-0.14742 -0.01031 -0.00035  0.00993  1.00688 
<span id="line100"></span>Coefficients:
<span id="line101"></span>                   Estimate Std. Error t value Pr(&gt;|t|)    
<span id="line102"></span>(Intercept)       0.0816199  0.0007291  111.95   </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16 ***
<span id="line103"></span>data$whole_weight 0.0698672  0.0007571   92.29   </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16 ***
<span id="line104"></span>---
<span id="line105"></span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
<span id="line106"></span>Residual standard error: 0.02399 on 4174 degrees of freedom
<span id="line107"></span>Multiple R-squared:  0.6711,	Adjusted R-squared:  0.671 
<span id="line108"></span>F-statistic:  8517 on 1 and 4174 DF,  p-value: </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2.2e-16
<span id="line109"></span>&gt; plot(lin.Model2)
<span id="line110"></span>&gt; lin.Model3 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(data$whole_weight ~ .,data=data)
<span id="line111"></span>&gt; summary(lin.Model3)
<span id="line112"></span>Call:
<span id="line113"></span>lm(formula = data$whole_weight ~ ., data = data)
<span id="line114"></span>Residuals:
<span id="line115"></span>     Min       1Q   Median       3Q      Max 
<span id="line116"></span>-0.54657 -0.01739 -0.00194  0.01175  0.51820 
<span id="line117"></span>Coefficients:
<span id="line118"></span>                 Estimate Std. Error t value Pr(&gt;|t|)    
<span id="line119"></span>(Intercept)    -0.0275208  0.0062309  -4.417 1.03e-05 ***
<span id="line120"></span>sexInfant      -0.0018702  0.0021643  -0.864    0.388    
<span id="line121"></span>sexMale        -0.0009144  0.0017485  -0.523    0.601    
<span id="line122"></span>length         -0.0253368  0.0379483  -0.668    0.504    
<span id="line123"></span>diameter        0.0160386  0.0468599   0.342    0.732    
<span id="line124"></span>height         -0.0072700  0.0324204  -0.224    0.823    
<span id="line125"></span>shucked_weight  0.9785924  0.0102694  95.292  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16 ***
<span id="line126"></span>viscera_weight  1.0981406  0.0214198  51.268  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16 ***
<span id="line127"></span>shell_weight    1.1543675  0.0156471  73.775  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16 ***
<span id="line128"></span>rings           0.0039522  0.0003194  12.374  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16 ***
<span id="line129"></span>---
<span id="line130"></span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
<span id="line131"></span>Residual standard error: 0.04602 on 4166 degrees of freedom
<span id="line132"></span>Multiple R-squared:  0.9912,	Adjusted R-squared:  0.9912 
<span id="line133"></span>F-statistic: 5.221e+04 on 9 and 4166 DF,  p-value: </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2.2e-16
<span id="line134"></span>&gt; plot(lin.Model3)
<span id="line135"></span>```
<span id="line136"></span>### Уберем выбросы
<span id="line137"></span>
<span id="line138"></span>```
<span id="line139"></span>&gt; data</span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span>data[data$height</span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;=</span><span>0.18<span><span class="error" title="«&amp;» не начинает ссылку на символ. («&amp;» вероятно должен быть экранирован как «&amp;amp;»).">&amp;</span>da</span>ta$height&gt;0.08,]
<span id="line140"></span>&gt; hist(data$height)
<span id="line141"></span>&gt; 
<span id="line142"></span>&gt; data</span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span>data[data$diameter</span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;=</span><span>0.52<span><span class="error" title="«&amp;» не начинает ссылку на символ. («&amp;» вероятно должен быть экранирован как «&amp;amp;»).">&amp;</span>da</span>ta$diameter&gt;0.26,]
<span id="line143"></span>&gt; 
<span id="line144"></span>&gt; hist(data$diameter)
<span id="line145"></span>&gt; 
<span id="line146"></span>&gt; data</span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span>data[data$whole_weight</span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;=</span><span>1.4<span><span class="error" title="«&amp;» не начинает ссылку на символ. («&amp;» вероятно должен быть экранирован как «&amp;amp;»).">&amp;</span>da</span>ta$whole_weight&gt;0.2,]
<span id="line147"></span>&gt; 
<span id="line148"></span>&gt; hist(data$whole_weight)
<span id="line149"></span>```
<span id="line150"></span>
<span id="line151"></span>### Проверим модели еще раз
<span id="line152"></span>
<span id="line153"></span>```
<span id="line154"></span>&gt; lin.Model1 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(data$diameter ~ data$whole_weight)
<span id="line155"></span>&gt; summary(lin.Model1)
<span id="line156"></span>Call:
<span id="line157"></span>lm(formula = data$diameter ~ data$whole_weight)
<span id="line158"></span>Residuals:
<span id="line159"></span>      Min        1Q    Median        3Q       Max 
<span id="line160"></span>-0.128109 -0.013161  0.000879  0.014429  0.101601 
<span id="line161"></span>Coefficients:
<span id="line162"></span>                  Estimate Std. Error t value Pr(&gt;|t|)    
<span id="line163"></span>(Intercept)       0.262660   0.001046   251.1   </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16 ***
<span id="line164"></span>data$whole_weight 0.192801   0.001279   150.8   </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16 ***
<span id="line165"></span>---
<span id="line166"></span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
<span id="line167"></span>Residual standard error: 0.02185 on 2972 degrees of freedom
<span id="line168"></span>Multiple R-squared:  0.8844,	Adjusted R-squared:  0.8843 
<span id="line169"></span>F-statistic: 2.273e+04 on 1 and 2972 DF,  p-value: </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2.2e-16
<span id="line170"></span>&gt; plot(lin.Model1)
<span id="line171"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line172"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line173"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line174"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line175"></span>&gt; lin.Model2 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span>lm(data$height ~ data$whole_weight)
<span id="line176"></span>&gt; summary(lin.Model2)
<span id="line177"></span>Call:
<span id="line178"></span>lm(formula = data$height ~ data$whole_weight)
<span id="line179"></span>Residuals:
<span id="line180"></span>      Min        1Q    Median 
<span id="line181"></span>-0.066346 -0.008823 -0.000632 
<span id="line182"></span>       3Q       Max 
<span id="line183"></span> 0.007976  0.063340 
<span id="line184"></span>Coefficients:
<span id="line185"></span>                   Estimate
<span id="line186"></span>(Intercept)       0.0879212
<span id="line187"></span>data$whole_weight 0.0651667
<span id="line188"></span>                  Std. Error
<span id="line189"></span>(Intercept)        0.0006326
<span id="line190"></span>data$whole_weight  0.0007735
<span id="line191"></span>                  t value
<span id="line192"></span>(Intercept)        138.98
<span id="line193"></span>data$whole_weight   84.25
<span id="line194"></span>                  Pr(&gt;|t|)    
<span id="line195"></span>(Intercept)         </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16 ***
<span id="line196"></span>data$whole_weight   </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;2</span><span>e-16 ***
<span id="line197"></span>---
<span id="line198"></span>Signif. codes:  
<span id="line199"></span>  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’
<span id="line200"></span>  0.05 ‘.’ 0.1 ‘ ’ 1
<span id="line201"></span>Residual standard error: 0.01321 on 2972 degrees of freedom
<span id="line202"></span>Multiple R-squared:  0.7048,	Adjusted R-squared:  0.7047 
<span id="line203"></span>F-statistic:  7097 on 1 and 2972 DF,  p-value: </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2.2e-16
<span id="line204"></span>&gt; plot(lin.Model2)
<span id="line205"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line206"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line207"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line208"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line209"></span>&gt; lin.Model3 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(data$whole_weight ~ .,data=data)
<span id="line210"></span>&gt; summary(lin.Model3)
<span id="line211"></span>Call:
<span id="line212"></span>lm(formula = data$whole_weight ~ ., data = data)
<span id="line213"></span>Residuals:
<span id="line214"></span>     Min       1Q   Median 
<span id="line215"></span>-0.33756 -0.01458 -0.00249 
<span id="line216"></span>      3Q      Max 
<span id="line217"></span> 0.00992  0.28866 
<span id="line218"></span>Coefficients:
<span id="line219"></span>                 Estimate
<span id="line220"></span>(Intercept)    -0.0569746
<span id="line221"></span>sexInfant      -0.0059464
<span id="line222"></span>sexMale        -0.0004383
<span id="line223"></span>length          0.0432648
<span id="line224"></span>diameter        0.0610791
<span id="line225"></span>height          0.0750174
<span id="line226"></span>shucked_weight  0.9795758
<span id="line227"></span>viscera_weight  0.9859411
<span id="line228"></span>shell_weight    1.0909452
<span id="line229"></span>rings           0.0033059
<span id="line230"></span>               Std. Error
<span id="line231"></span>(Intercept)     0.0090711
<span id="line232"></span>sexInfant       0.0016696
<span id="line233"></span>sexMale         0.0014199
<span id="line234"></span>length          0.0328528
<span id="line235"></span>diameter        0.0404433
<span id="line236"></span>height          0.0471937
<span id="line237"></span>shucked_weight  0.0106797
<span id="line238"></span>viscera_weight  0.0209855
<span id="line239"></span>shell_weight    0.0185611
<span id="line240"></span>rings           0.0002702
<span id="line241"></span>               t value Pr(&gt;|t|)
<span id="line242"></span>(Intercept)     -6.281 3.86e-10
<span id="line243"></span>sexInfant       -3.562 0.000374
<span id="line244"></span>sexMale         -0.309 0.757551
<span id="line245"></span>length           1.317 0.187964
<span id="line246"></span>diameter         1.510 0.131088
<span id="line247"></span>height           1.590 0.112040
<span id="line248"></span>shucked_weight  91.723  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16
<span id="line249"></span>viscera_weight  46.982  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16
<span id="line250"></span>shell_weight    58.776  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16
<span id="line251"></span>rings           12.234  </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2e-16
<span id="line252"></span>                  
<span id="line253"></span>(Intercept)    ***
<span id="line254"></span>sexInfant      ***
<span id="line255"></span>sexMale           
<span id="line256"></span>length            
<span id="line257"></span>diameter          
<span id="line258"></span>height            
<span id="line259"></span>shucked_weight ***
<span id="line260"></span>viscera_weight ***
<span id="line261"></span>shell_weight   ***
<span id="line262"></span>rings          ***
<span id="line263"></span>---
<span id="line264"></span>Signif. codes:  
<span id="line265"></span>  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’
<span id="line266"></span>  0.05 ‘.’ 0.1 ‘ ’ 1
<span id="line267"></span>Residual standard error: 0.0316 on 2964 degrees of freedom
<span id="line268"></span>Multiple R-squared:  0.9899,	Adjusted R-squared:  0.9898 
<span id="line269"></span>F-statistic: 3.215e+04 on 9 and 2964 DF,  p-value: </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt; </span><span>2.2e-16
<span id="line270"></span>&gt; plot(lin.Model3)
<span id="line271"></span>```
<span id="line272"></span>
<span id="line273"></span>### Разделить массив данных на 2 случайные части
<span id="line274"></span>
<span id="line275"></span>```
<span id="line276"></span>&gt; firstMass </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> data[seq(1, nrow(data), by=2),]
<span id="line277"></span>&gt; secondMass </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> data[-seq(1, nrow(data), by=2),]
<span id="line278"></span>&gt; summary(firstMass)
<span id="line279"></span>     sex          length          diameter     
<span id="line280"></span> Female:465   Min.   :0.1850   Min.   :0.2650  
<span id="line281"></span> Infant:496   1st Qu.:0.4650   1st Qu.:0.3575  
<span id="line282"></span> Male  :526   Median :0.5300   Median :0.4150  
<span id="line283"></span>              Mean   :0.5237   Mean   :0.4074  
<span id="line284"></span>              3rd Qu.:0.5850   3rd Qu.:0.4600  
<span id="line285"></span>              Max.   :0.7100   Max.   :0.5200  
<span id="line286"></span>     height        whole_weight    shucked_weight  
<span id="line287"></span> Min.   :0.0850   Min.   :0.2010   Min.   :0.0660  
<span id="line288"></span> 1st Qu.:0.1200   1st Qu.:0.4870   1st Qu.:0.2057  
<span id="line289"></span> Median :0.1400   Median :0.7420   Median :0.3115  
<span id="line290"></span> Mean   :0.1367   Mean   :0.7513   Mean   :0.3269  
<span id="line291"></span> 3rd Qu.:0.1550   3rd Qu.:0.9948   3rd Qu.:0.4395  
<span id="line292"></span> Max.   :0.1800   Max.   :1.3900   Max.   :0.7335  
<span id="line293"></span> viscera_weight    shell_weight        rings       
<span id="line294"></span> Min.   :0.0260   Min.   :0.0550   Min.   : 5.000  
<span id="line295"></span> 1st Qu.:0.1045   1st Qu.:0.1435   1st Qu.: 8.000  
<span id="line296"></span> Median :0.1600   Median :0.2175   Median : 9.000  
<span id="line297"></span> Mean   :0.1641   Mean   :0.2179   Mean   : 9.861  
<span id="line298"></span> 3rd Qu.:0.2182   3rd Qu.:0.2873   3rd Qu.:11.000  
<span id="line299"></span> Max.   :0.4405   Max.   :0.5800   Max.   :27.000  
<span id="line300"></span>&gt; 
<span id="line301"></span>&gt; summary(secondMass)
<span id="line302"></span>     sex          length          diameter     
<span id="line303"></span> Female:465   Min.   :0.3350   Min.   :0.2650  
<span id="line304"></span> Infant:469   1st Qu.:0.4700   1st Qu.:0.3600  
<span id="line305"></span> Male  :553   Median :0.5300   Median :0.4150  
<span id="line306"></span>              Mean   :0.5263   Mean   :0.4092  
<span id="line307"></span>              3rd Qu.:0.5900   3rd Qu.:0.4600  
<span id="line308"></span>              Max.   :0.6850   Max.   :0.5200  
<span id="line309"></span>     height        whole_weight    shucked_weight  
<span id="line310"></span> Min.   :0.0850   Min.   :0.2055   Min.   :0.0660  
<span id="line311"></span> 1st Qu.:0.1200   1st Qu.:0.4940   1st Qu.:0.2080  
<span id="line312"></span> Median :0.1400   Median :0.7640   Median :0.3195  
<span id="line313"></span> Mean   :0.1376   Mean   :0.7596   Mean   :0.3297  
<span id="line314"></span> 3rd Qu.:0.1550   3rd Qu.:1.0128   3rd Qu.:0.4385  
<span id="line315"></span> Max.   :0.1800   Max.   :1.3940   Max.   :0.7830  
<span id="line316"></span> viscera_weight    shell_weight        rings       
<span id="line317"></span> Min.   :0.0345   Min.   :0.0585   Min.   : 5.000  
<span id="line318"></span> 1st Qu.:0.1057   1st Qu.:0.1485   1st Qu.: 8.000  
<span id="line319"></span> Median :0.1615   Median :0.2200   Median : 9.000  
<span id="line320"></span> Mean   :0.1665   Mean   :0.2207   Mean   : 9.966  
<span id="line321"></span> 3rd Qu.:0.2205   3rd Qu.:0.2888   3rd Qu.:11.000  
<span id="line322"></span> Max.   :0.4365   Max.   :0.5200   Max.   :23.000  
<span id="line323"></span>&gt; lnFirstMass </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(firstMass$diameter ~ firstMass$whole_weight)
<span id="line324"></span>&gt; lnFirstMass
<span id="line325"></span>Call:
<span id="line326"></span>lm(formula = firstMass$diameter ~ firstMass$whole_weight)
<span id="line327"></span>Coefficients:
<span id="line328"></span>           (Intercept)  
<span id="line329"></span>                0.2627  
<span id="line330"></span>firstMass$whole_weight  
<span id="line331"></span>                0.1926  
<span id="line332"></span>&gt; plot(lnFirstMass)
<span id="line333"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line334"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line335"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line336"></span>Hit </span><span>&lt;<span class="start-tag">Return</span>&gt;</span><span> to see next plot: 
<span id="line337"></span>&gt; lnSecondMass </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(secondMass$diameter ~ secondMass$whole_weight)
<span id="line338"></span>&gt; plot(lnSecondMass)
<span id="line339"></span>&gt; lnFirstMass2 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(firstMass$height ~ firstMass$whole_weight)
<span id="line340"></span>&gt; lnFirstMass3 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> lm(firstMass$whole_weight ~ .,data=firstMass)
<span id="line341"></span>```
<span id="line342"></span>
<span id="line343"></span>### спрогнозировать (функция predict) значения во второй части
<span id="line344"></span>
<span id="line345"></span>### First prediction
<span id="line346"></span>```
<span id="line347"></span>&gt; prediction1 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> predict(lnFirstMass)
<span id="line348"></span>&gt; cor(firstMass$whole_weight, prediction1)
<span id="line349"></span>[1] 1
<span id="line350"></span>&gt; plot(firstMass$whole_weight, prediction1)
<span id="line351"></span>&gt; totPrediction1 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> predict(lnFirstMass, secondMass)
<span id="line352"></span>&gt; cor(secondMass$whole_weight, totPrediction1)
<span id="line353"></span>[1] 0.7176496
<span id="line354"></span>&gt; plot(secondMass$whole_weight, totPrediction1)
<span id="line355"></span>```
<span id="line356"></span>
<span id="line357"></span>### Second prediction
<span id="line358"></span>
<span id="line359"></span>```
<span id="line360"></span>&gt; prediction2 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> predict(lnFirstMass2)
<span id="line361"></span>&gt; cor(firstMass$whole_weight, prediction2)
<span id="line362"></span>[1] 1
<span id="line363"></span>&gt; plot(firstMass$whole_weight, prediction2)
<span id="line364"></span>&gt; totPrediction2 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> predict(lnFirstMass2, secondMass)
<span id="line365"></span>&gt; cor(secondMass$whole_weight, totPrediction2)
<span id="line366"></span>[1] 0.7176496
<span id="line367"></span>&gt; plot(secondMass$whole_weight, totPrediction2)
<span id="line368"></span>```
<span id="line369"></span>
<span id="line370"></span>### Third prediction 
<span id="line371"></span>
<span id="line372"></span>```
<span id="line373"></span>&gt; prediction3 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> predict(lnFirstMass)
<span id="line374"></span>&gt; cor(firstMass$whole_weight, prediction3)
<span id="line375"></span>[1] 1
<span id="line376"></span>&gt; plot(firstMass$whole_weight, prediction3)
<span id="line377"></span>&gt; totPrediction3 </span><span class="error" title="Некорректный символ после «&lt;». Вероятная причина: Неэкранированный «&lt;». Попробуйте экранировать его как «&amp;lt;».">&lt;-</span><span> predict(lnFirstMass3, secondMass)
<span id="line378"></span>&gt; cor(secondMass$whole_weight, totPrediction3)
<span id="line379"></span>[1] 0.9949722
<span id="line380"></span>&gt; plot(secondMass$whole_weight, totPrediction3)
<span id="line381"></span>```</span></pre><menu type="context" id="actions"><menuitem id="goToLine" label="Перейти к строке…" accesskey="е"></menuitem><menuitem id="wrapLongLines" label="Переносить длинные строки" type="checkbox"></menuitem><menuitem id="highlightSyntax" label="Подсветка синтаксиса" type="checkbox" checked="true"></menuitem></menu></body></html>